#+STARTUP: content
* install
  #+BEGIN_SRC shell :tangle no
    git clone --depth=1 git@github.com:firslov/.emacs.d.git
  #+END_SRC
  #+BEGIN_SRC emacs-lisp :tangle no
    (org-babel-tangle-file "~/.emacs.d/readme.org" "~/.emacs.d/init.el")
  #+END_SRC
* packages
** resources
   :PROPERTIES:
   :ID:       97340501-662B-413F-B3B8-678BDDB9144C
   :END:
   #+BEGIN_SRC emacs-lisp
     ;; cl - Common Lisp Extension
     (require 'cl-lib)
     (when (>= emacs-major-version 24)
       (require 'package)
       (setq package-archives '(("gnu"   . "http://elpa.emacs-china.org/gnu/")
				("melpa" . "http://elpa.emacs-china.org/melpa/")))
       (package-initialize))
     (add-to-list 'load-path "~/.emacs.d/lisp")
   #+END_SRC
** use-package
   :PROPERTIES:
   :ID:       1717CB71-0345-4C43-BEF0-212714F90FAB
   :END:
   #+BEGIN_SRC emacs-lisp
     ;; Add use-package
     (unless (package-installed-p 'use-package)
       (package-refresh-contents)
       (package-install 'use-package))
   #+END_SRC
** packages
*** benchmark-init
    :PROPERTIES:
    :ID:       AE42AC82-2940-4C64-9275-9743896542D2
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package benchmark-init
	:ensure t
	:config
	;; To disable collection of benchmark data after init is done.
	(add-hook 'after-init-hook 'benchmark-init/deactivate))
    #+END_SRC
*** early-packages
    :PROPERTIES:
    :ID:       0D34073A-4A54-4BF9-B0FB-42D3D24AB909
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package org
	:ensure t)
      (use-package org-bullets
	:ensure t
	:config
	(add-hook 'org-mode-hook (lambda () (org-bullets-mode 1))))
      (use-package auto-load)
      (use-package recentf
	:bind ("C-x C-r" . recentf-open-files)
	:defer 1
	:config
	(recentf-mode 1)
	(setq recentf-max-menu-item 10))
      (use-package exec-path-from-shell
	:ensure t
	:config
	(setq exec-path-from-shell-arguments '("-l"))
	(when (memq window-system '(mac ns x))
	  (exec-path-from-shell-initialize)))
    #+END_SRC
*** magit
    :PROPERTIES:
    :ID:       04816A3E-C8F4-49E3-B841-40C2F49307D9
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package magit
	:ensure t
	:defer t
	:bind ("C-x g" . magit-status))
    #+END_SRC
*** which-key
    :PROPERTIES:
    :ID:       C69066D7-855C-4534-A1B6-336CE914C12A
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package which-key
	:ensure t
	:config (which-key-mode))
    #+END_SRC
*** neotree
    :PROPERTIES:
    :ID:       776E7BB9-3EA2-46E9-8924-7312793A6BD9
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package neotree
	:ensure t
	:config
	(setq neo-theme (if (display-graphic-p) 'icons 'arrow))
	(setq projectile-switch-project-action 'neotree-projectile-action))
    #+END_SRC
*** org
    :PROPERTIES:
    :ID:       48B39155-CD67-4AF6-9ACF-AFD54F80D111
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package org-sidebar
	:ensure t
	:after (general)
	:config
	(leader-def :infix "o"
		    "b" 'org-sidebar-backlinks))
      (use-package org-download
	:ensure t
	:config
	;; Drag-and-drop to `dired`
	(add-hook 'dired-mode-hook 'org-download-enable)
	(setq-default org-download-image-dir "./src")
	(setq org-download-display-inline-images nil))
      (use-package org-z
	:ensure helm-rg
	:ensure helm-org-rifle
	:load-path "~/.emacs.d/git-repo/org-z"
	:config
	(org-z-mode 1))
    #+END_SRC
*** highlight-parentheses
    :PROPERTIES:
    :ID:       2329836B-C428-4971-876F-51B013A0D0F1
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package highlight-parentheses
	:ensure t
	:config
	(define-globalized-minor-mode global-highlight-parentheses-mode
	  highlight-parentheses-mode
	  (lambda ()
	    (highlight-parentheses-mode t)))
	(global-highlight-parentheses-mode t))
    #+END_SRC
*** youdao-dictionary
    :PROPERTIES:
    :ID:       AD65F58C-B73A-46FD-A415-C1793491265B
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package youdao-dictionary
	:ensure t
	:defer t
	:config
	;; enable cache
	(setq url-automatic-caching t))
    #+END_SRC
*** swiper
    :PROPERTIES:
    :ID:       0FF8B4DF-C402-461B-B7F0-7D29DC729012
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package counsel
	:ensure t)
      (use-package swiper
	:ensure t
	:bind (
	       ("C-s" . swiper)
	       ("M-n" . next-error)
	       ("M-p" . previous-error)
	       ("C-c C-r" . ivy-resume)
	       ("M-x" . counsel-M-x)
	       ("C-x C-f" . counsel-find-file)
	       ("<f1> f" . counsel-describe-function)
	       ("<f1> v" . counsel-describe-variable)
	       ("<f1> o" . counsel-describe-symbol)
	       ("<f1> l" . counsel-find-library)
	       ("C-c g" . counsel-git)
	       ("C-c j" . counsel-git-grep)
	       )
	:config
	(ivy-mode 1)
	(setq ivy-use-virtual-buffers t)
	(setq enable-recursive-minibuffers t)
	(setq ivy-use-virtual-buffers t)
	(setq enable-recursive-minibuffers t))
    #+END_SRC
*** doom
    :PROPERTIES:
    :ID:       85AE1630-1E1D-44AD-93EB-726DEFBD6216
    :END:
    #+BEGIN_SRC emacs-lisp
      ;; (use-package doom-themes
      ;;   :ensure t)
      ;; (use-package doom-modeline
      ;;   :ensure t
      ;;   :hook (emacs-startup . doom-modeline-mode)
      ;;   :config
      ;;   (setq
      ;;    ;; inhibit-compacting-font-caches t
      ;;    ;; doom-modeline-height 1
      ;;    doom-modeline-buffer-file-name-style 'auto
      ;;    ;; doom-modeline-icon nil
      ;;    ;; doom-modeline-project-detection 'project
      ;;    ))
    #+END_SRC
*** company
    :PROPERTIES:
    :ID:       D18BD5DD-0999-4B41-8377-F3400B53BC24
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package company
	:ensure t
	:config
	(add-hook 'after-init-hook 'global-company-mode))
    #+END_SRC
*** yasnippet
    :PROPERTIES:
    :ID:       B84EBBF6-E3CB-43A3-B85F-8BD8C9BB4775
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package yasnippet
	:ensure t
	:config
	(setq yas-snippet-dirs
	      '("~/.emacs.d/snippets"))
	(yas-global-mode 1))
    #+END_SRC
*** undo-tree
    :PROPERTIES:
    :ID:       314D4536-11DE-4A8C-8E90-FAFF26B9F988
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package undo-tree
	:ensure t
	:config (global-undo-tree-mode))
    #+END_SRC
*** projectile
    :PROPERTIES:
    :ID:       65CB8CCD-B584-4AAA-8BAD-E5E12CD8DAFE
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package projectile
	:ensure t
	:config
	(projectile-mode +1)
	(define-key projectile-mode-map (kbd "C-c p") 'projectile-command-map)
	(setq projectile-indexing-method 'native)
	(setq projectile-completion-system 'ivy))
    #+END_SRC
*** phd
    :PROPERTIES:
    :ID:       AD26ABAB-EB75-4F76-A0D4-655AE01FCF82
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package phd
	:defer t)
      (when (display-graphic-p)
	(use-package pdf-view
	  :ensure pdf-tools
	  :diminish (pdf-view-midnight-minor-mode pdf-view-printer-minor-mode)
	  :defines pdf-annot-activate-created-annotations
	  :functions my-pdf-view-set-midnight-colors
	  :commands pdf-view-midnight-minor-mode
	  :mode ("\\.[pP][dD][fF]\\'" . pdf-view-mode)
	  :magic ("%PDF" . pdf-view-mode)
	  :hook (after-load-theme . my-pdf-view-set-dark-theme)
	  :bind (:map pdf-view-mode-map
		      ("C-s" . isearch-forward))
	  :init
	  (add-to-list 'org-file-apps '("\\.pdf\\'" . pdf-view))
	  (setq pdf-annot-activate-created-annotations t)

	  (defun my-pdf-view-set-midnight-colors ()
	    "Set pdf-view midnight colors."
	    (setq pdf-view-midnight-colors
		  `(,(face-foreground 'default) . ,(face-background 'default))))

	  (defun my-pdf-view-set-dark-theme ()
	    "Set pdf-view midnight theme as color theme."
	    (my-pdf-view-set-midnight-colors)
	    (dolist (buf (buffer-list))
	      (with-current-buffer buf
		(when (eq major-mode 'pdf-view-mode)
		  (pdf-view-midnight-minor-mode (if pdf-view-midnight-minor-mode 1 -1))))))
	  :config
	  ;; WORKAROUND: Fix compilation errors on macOS.
	  ;; @see https://github.com/politza/pdf-tools/issues/480
	  (pdf-tools-install t nil t t)

	  (my-pdf-view-set-midnight-colors)

	  ;; FIXME: Support retina
	  ;; @see https://emacs-china.org/t/pdf-tools-mac-retina-display/10243/
	  ;; and https://github.com/politza/pdf-tools/pull/501/
	  (setq pdf-view-use-scaling t
		pdf-view-use-imagemagick nil)
	  (with-no-warnings
	    (defun pdf-view-use-scaling-p ()
	      "Return t if scaling should be used."
	      (and (or (and (eq system-type 'darwin) (string-equal emacs-version "27.0.50"))
		       (memq (pdf-view-image-type)
			     '(imagemagick image-io)))
		   pdf-view-use-scaling))
	    (defun pdf-view-create-page (page &optional window)
	      "Create an image of PAGE for display on WINDOW."
	      (let* ((size (pdf-view-desired-image-size page window))
		     (width (if (not (pdf-view-use-scaling-p))
				(car size)
			      (* 2 (car size))))
		     (data (pdf-cache-renderpage
			    page width width))
		     (hotspots (pdf-view-apply-hotspot-functions
				window page size)))
		(pdf-view-create-image data
				       :width width
				       :scale (if (pdf-view-use-scaling-p) 0.5 1)
				       :map hotspots
				       :pointer 'arrow))))

	  ;; Recover last viewed position
	  (use-package pdf-view-restore
	    :hook (pdf-view-mode . pdf-view-restore-mode)
	    :init (setq pdf-view-restore-filename
			(locate-user-emacs-file ".pdf-view-restore")))))
      ;; (use-package interleave
      ;;   :defer t
      ;;   :ensure t
      ;;   :config
      ;;   (setq interleave-split-direction 'horizontal)
      ;;   (setq interleave-split-lines 9))
      (use-package shengci
	:ensure f
	:load-path "~/.emacs.d/git-repo/shengci.el")
    #+END_SRC
*** awesome
**** lazycat-theme
     :PROPERTIES:
     :ID:       E8AD9286-3D39-41A1-AFAC-F6C7C7287E9A
     :END:
     #+BEGIN_SRC emacs-lisp
       (use-package lazycat-theme
	 :load-path "~/.emacs.d/git-repo/lazycat-theme")
     #+END_SRC
**** awesome-tray
     :PROPERTIES:
     :ID:       B0802DE7-EDDF-491E-9795-6A3559A19E80
     :END:
     #+BEGIN_SRC emacs-lisp
       (use-package awesome-tray
	 :load-path "~/.emacs.d/git-repo/awesome-tray"
	 :init (setq awesome-tray-active-modules '("parent-dir" "mode-name" "git" "date"))
	 :config
	 (awesome-tray-mode 1)
	 (lazycat-theme-load-dark))
     #+END_SRC
**** awesome-tab
     :PROPERTIES:
     :ID:       1EB14998-A29C-47E0-937F-3A7C8C145D4D
     :END:
     #+BEGIN_SRC emacs-lisp
       (use-package awesome-tab
	 :load-path "~/.emacs.d/git-repo/awesome-tab"
	 :config
	 (awesome-tab-mode t))
     #+END_SRC
*** misc packages
    :PROPERTIES:
    :ID:       AC8F6590-5AAB-4D29-8CA8-89B296C1781F
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package all-the-icons
	:ensure t) 
      (use-package restart-emacs
	:ensure t
	:defer t
	:init
	(defun b-restart-emacs (f)
	  (org-babel-tangle-file "~/.emacs.d/readme.org" "~/.emacs.d/init.el"))
	(advice-add #'restart-emacs :before #'b-restart-emacs))
      (use-package ace-window
	:ensure t
	:defer t
	:config
	(global-set-key [remap other-window] 'ace-window)
	(custom-set-faces
	 '(aw-leading-char-face
	   ((t (:inderit ace-jump-face-foreground :height 3.0))))))
      (use-package diminish
	:ensure t
	:diminish (ivy-mode eldoc-mode which-key-mode))
      (use-package org-equation-live-preview
	:load-path "~/.emacs.d/git-repo/org-equation-live-preview"
	:defer t)
      (use-package learn-timer
	:load-path "~/.emacs.d/lisp/learn-timer/"
	:after awesome-tray
	:config
	(add-to-list 'awesome-tray-active-modules "timer" 'append)
	(add-to-list 'awesome-tray-active-modules "todo" 'append)
	)
      (use-package auto-save
	:config
	(auto-save-enable)              ;; 开启自动保存功能
	(setq auto-save-slient t)       ;; 自动保存的时候静悄悄的， 不要打扰我
	)
      (use-package auto-indent
	:config (auto-indent-enable))
      (use-package posframe
	:config
	(defun call-a-posframe ()
	  (interactive)
	  (defvar my-posframe-buffer " *my-posframe-buffer*")
	  (with-current-buffer (get-buffer-create my-posframe-buffer)
	    (erase-buffer)
	    (insert "Hello world"))
	  (when (posframe-workable-p)
	    (posframe-show my-posframe-buffer
			   :position (point))))
	)
    #+END_SRC
** python
*** elpy
    :PROPERTIES:
    :ID:       379380BA-9AED-4702-8359-2A86D6912D5E
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package elpy
	:ensure t
	:defer t
	:config
	(elpy-enable)
	;; Use IPython for REPL
	(setq python-shell-interpreter "jupyter"
	      python-shell-interpreter-args "console --simple-prompt"
	      python-shell-prompt-detect-failure-warning nil)
	(add-to-list 'python-shell-completion-native-disabled-interpreters
		     "jupyter"))
    #+END_SRC
*** py-autopep8
    :PROPERTIES:
    :ID:       E7151DC5-C1C8-4ACF-8F12-D5FEBF03718B
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package py-autopep8
	:ensure t
	:defer t
	:config
	(add-hook 'elpy-mode-hook 'py-autopep8-enable-on-save)
	(setq py-autopep8-options '("--max-line-length=100")))
    #+END_SRC
*** flycheck
    :PROPERTIES:
    :ID:       DAA2F427-8B0C-414F-9388-8E42E6582340
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package flycheck
	:ensure t
	:defer t
	:config
	(global-flycheck-mode)
	(setq elpy-modules (delq 'elpy-module-flymake elpy-modules))
	(add-hook 'elpy-mode-hook 'flycheck-mode))
    #+END_SRC
*** ein
    :PROPERTIES:
    :ID:       84DA2846-4C20-4C64-8634-3EA4F68EBBE4
    :END:
    #+BEGIN_SRC emacs-lisp
      (use-package ein
	:ensure t
	)
    #+END_SRC
* diff-sys
** window-nt
   :PROPERTIES:
   :ID:       B3D646C1-74F3-411A-9C5E-B4FC23FD1786
   :END:
   #+BEGIN_SRC emacs-lisp
     (when (eq system-type 'windows-nt)
       (setq conf_dir "e:/emacs/.emacs.d/"
	     org-directory "e:/org/"
	     init-file (concat conf_dir "lisp/init-main.el")
	     init-sys (concat conf_dir "lisp/windows-nt.el"))
       ;; init fullscreen
       (add-to-list 'default-frame-alist '(fullscreen . maximized))
       )
   #+END_SRC
** darwin
   :PROPERTIES:
   :ID:       C12DCED6-8288-4305-BC4D-DCBA114FA0DD
   :END:
   #+BEGIN_SRC emacs-lisp
     (when (eq system-type 'darwin)
       (setq conf_dir "~/.emacs.d/"
	     org-directory "~/org/"
	     init-file (concat conf_dir "lisp/init-main.el")
	     init-sys (concat conf_dir "lisp/darwin.el"))
       ;; font
       (set-face-attribute 'default nil :font "MesloLGLDZ Nerd Font 15")
       ;; env
       (setenv "PATHONPATH" "/opt/anaconda3/bin")
       (setenv "PATH" "/opt/anaconda3/bin:/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin:/usr/local/sbin")
       (setq python-shell-interpreter "/opt/anaconda3/bin/python3")
       (setq ein:jupyter-server-command "/opt/anaconda3/bin/jupyter")
       )
   #+END_SRC
** linux
   :PROPERTIES:
   :ID:       B3893371-65D2-447B-AC36-988CB4AB095B
   :END:
   #+BEGIN_SRC emacs-lisp
     (when (eq system-type 'gnu/linux)
       (setq conf_dir "~/.emacs.d/"
	     org-directory "~/org/"
	     init-file (concat conf_dir "lisp/init-main.el")
	     init-sys (concat conf_dir "lisp/darwin.el"))
       )
   #+END_SRC
* user-config
** config
   :PROPERTIES:
   :ID:       ECE09DC4-1553-4728-A40F-448A66828EE6
   :END:
   #+BEGIN_SRC emacs-lisp
     ;; 启动页面
     ;; (setq initial-buffer-choice (concat org-directory "note.org"))
     ;; 强制左右分屏
     (setq split-height-threshold nil)
     (setq split-width-threshold 0)
     ;; 关闭欢迎界面
     (setq inhibit-splash-screen t)
     ;; fonts problem
     (setq inhibit-compacting-font-caches t)
     ;; Enable line numbers globally
     ;; (global-linum-mode nil)
     ;; disable alert voice
     (setq ring-bell-function 'ignore)
     ;; UI
     (tool-bar-mode 0)
     (scroll-bar-mode 0)
     (menu-bar-mode t)
     ;; Highlight the "()"
     (show-paren-mode t)
     ;; Auto complete the "()"
     (electric-pair-mode t)
     ;; Set the electric-pair-mode's pair keywords
     (setq electric-pair-pairs
	   '((?\" . ?\")
	     (?\( . ?\))
	     ;;(?\< . ?\>)
	     (?\{ . ?\})))
     (setq-default cursor-type 'bar)
     ;; Save the point position
     (save-place-mode t)
     ;; 设置默认读入文件编码
     (prefer-coding-system 'gbk)
     ;; 设置写入文件编码
     (setq default-buffer-file-coding-system 'gbk)
     ;; disable backup
     (setq make-backup-files nil)
     ;; disable auto-save
     (setq auto-save-default nil)
     ;; yes-or-no y-or-n
     (fset 'yes-or-no-p 'y-or-n-p)
     ;; select input delete
     (delete-selection-mode 1)
     ;; highlight current line
     (global-hl-line-mode 1)
     ;; autoload change out of emacs
     (global-auto-revert-mode 1)
     ;; highlight in org-mode
     (setq org-src-fontify-natively t)
     ;; 自动换行
     (toggle-truncate-lines 1)
     ;; emacs guess indent
     (setq python-indent-guess-indent-offset nil)
     ;; display buffer alist
     (setq display-buffer-alist
	   '(("\\*e?shell\\*"
	      (display-buffer-in-side-window)
	      (window-height . 0.3)
	      (side . bottom)
	      (slot . -1))
	     ("\\*\\(Backtrace\\|Warnings\\|Compile-Log\\|[Hh]elp\\|Messages\\)\\*"
	      (display-buffer-in-side-window)
	      (window-width . 0.5)
	      (side . right)
	      (slot . 1))
	     ))
   #+END_SRC
** key-bind
   :PROPERTIES:
   :ID:       CA293065-0957-498D-9EAC-03F8C60671B3
   :END:
   #+BEGIN_SRC emacs-lisp
     ;; save all buffers
     (global-set-key (kbd "<f12>") 'org-save-all-org-buffers)
     ;; 绑定 <f5> <f6> 键上
     (global-set-key (kbd "<f5>") 'youdao-dictionary-search-at-point-posframe)
     (global-set-key (kbd "<f6>") 'youdao-dictionary-play-voice-at-point)
     ;; ibuffer
     (global-set-key (kbd "C-x C-b") 'ibuffer)
     ;; show startup page
     (global-set-key (kbd "C-.") 'show-startup-page)
     ;; 将函数 load-init-file 绑定到 <f1> 0 键上
     (global-set-key (kbd "<f1> 0") 'load-init)
     ;; 将函数 open-init-file 绑定到 <f1> 1 键上
     (global-set-key (kbd "<f1> 1") 'open-init-file)
     ;; 将函数 open-articles 绑定到<f1> 2 键上
     (global-set-key (kbd "<f1> 2") 'open-articles)
     ;; 将函数 org-todo 绑定到<f1> 3 键上
     (global-set-key (kbd "<f1> 3") 'org-todo-list)
     ;; 将函数 indent-buffer 绑定到 <f8> 键上
     (global-set-key (kbd "<f8>") 'indent-buffer)
     ;; 上下翻半页
     (global-set-key "\M-n" 'scroll-half-page-up)
     (global-set-key "\M-p" 'scroll-half-page-down)
     ;; 生词记录
     (global-set-key (kbd "<f7>") 'shengci-capture-word-and-save)
   #+END_SRC
** function
   :PROPERTIES:
   :ID:       1F58FF75-918F-442D-91EE-9400D579496E
   :END:
   #+BEGIN_SRC emacs-lisp
     ;; 快速打开配置文件
     (defun open-init-file()
       (interactive)
       (find-file (concat conf_dir "readme.org")))
     ;; 快速加载配置文件
     (defun load-init()
       (interactive)
       (org-babel-load-file (concat conf_dir "readme.org")))
     ;; 快速打开articles
     (defun open-articles()
       (interactive)
       (find-file "~/Documents/org/Archive.org"))
     ;; neotree list config-dir
     (defun nconf()
       (interactive)
       (neotree-dir conf_dir)
       (other-window -1))
     ;; format the buffer
     (defun indent-buffer()
       (interactive)
       (indent-region (point-min) (point-max)))
     ;; 翻页
     (defun scroll-half-page-down ()
       "scroll down half the page"
       (interactive)
       (scroll-down (/ (window-body-height) 2)))
     (defun scroll-half-page-up ()
       "scroll up half the page"
       (interactive)
       (scroll-up (/ (window-body-height) 2)))
     ;; 窗口启动位置大小
     (defun init-my-frame ()
       (set-frame-position (selected-frame) 160 80)
       (set-frame-width (selected-frame) 120)
       (set-frame-height (selected-frame) 30))
     (add-hook 'after-init-hook 'init-my-frame)
     ;; set alpha
     (defun set-alpha (var)
       "Set the backgroud alpha by VAR."
       (interactive "sAlpha or not(y-or-n): ")
       (pcase var
	 ("y" (set-frame-parameter nil 'alpha '(90 . 100)))
	 ("n" (set-frame-parameter nil 'alpha '(100 . 100)))))
     ;; 快速打开blog文件
     (defun blog()
       (interactive)
       (find-file "~/site/org/index.org")
       (blog-mode)
       (neotree-dir "~/site/"))
     ;; refresh startup function
     (defun show-startup-page()
       (interactive)
       (org-agenda-list)
       (org-agenda-day-view)
       (neotree-dir "~/Documents/org/")
       (other-window -1))
     ;; (add-hook 'window-setup-hook 'show-startup-page)
   #+END_SRC
** mode
   :PROPERTIES:
   :ID:       EAA724BA-845A-4F9A-A85B-2AA5013AA389
   :END:
   #+BEGIN_SRC emacs-lisp
     ;; blog mode
     (define-minor-mode blog-mode
       "Toggle blog mode."
       :global nil
       :lighter "Blog")
   #+END_SRC
** transparency
   :PROPERTIES:
   :ID:       66A9995E-1BAC-4B9D-BB88-911C7617B155
   :END:
   #+BEGIN_SRC emacs-lisp
     ;; @purcell
     (defun sanityinc/adjust-opacity (frame incr)
       "Adjust the background opacity of FRAME by increment INCR."
       (unless (display-graphic-p frame)
	 (error "Cannot adjust opacity of this frame"))
       (let* ((oldalpha (or (frame-parameter frame 'alpha) 100))
	      (oldalpha (if (listp oldalpha) (car oldalpha) oldalpha))
	      (newalpha (+ incr oldalpha)))
	 (when (and (<= frame-alpha-lower-limit newalpha) (>= 100 newalpha))
	   (modify-frame-parameters frame (list (cons 'alpha newalpha))))))
     (global-set-key (kbd "M-C-8") (lambda ()
				     (interactive)
				     (sanityinc/adjust-opacity nil -2)))
     (global-set-key (kbd "M-C-9") (lambda ()
				     (interactive)
				     (sanityinc/adjust-opacity nil 2)))
     (global-set-key (kbd "M-C-7") (lambda ()
				     (interactive)
				     (modify-frame-parameters nil `((alpha . 100)))))
   #+END_SRC
* org
  :PROPERTIES:
  :ID:       F9CC5F16-51C4-41E7-8428-AFDB43446F05
  :END:
  #+BEGIN_SRC emacs-lisp
    ;; org variables
    ;; (add-to-list 'org-file-apps '("\\.pdf\\'" . "Microsoft\ edge %s"))
    (add-hook 'org-mode-hook (lambda () (setq truncate-lines nil)))
    (add-hook 'org-mode-hook 'linum-mode)
    (setq org-agenda-files (list (concat org-directory "inbox.org"))
	  lt-todo-files org-agenda-files
	  org-agenda-skip-function-global '(org-agenda-skip-entry-if 'regexp "\\* DONE\\|\\* CANCELED")
	  ;; org-agenda-skip-function-global '(org-agenda-skip-entry-if 'notregexp "\\* DONE\\|\\* CANCELED")
	  org-agenda-show-future-repeats nil
	  org-deadline-warning-days 30
	  org-agenda-window-setup nil
	  org-M-RET-may-split-line '((headline . nil))
	  org-agenda-time-grid '((daily today require-timed)
				 (1000 1400 1600 2000 2200)
				 "......" "----------------")
	  org-capture-templates
	  `(("i" "Inbox" entry (file+headline ,(concat org-directory "inbox.org") "Inbox:")
	     "* %?" :unnarrowed t)
	    ("j" "Journal" entry (file+datetree ,(concat org-directory "journal.org"))
	     "* %U\n%?" :unnarrowed t)
	    ("a" "Arrangement" entry (file+headline ,(concat org-directory "inbox.org") "Arrangement:")
	     "* %? %^T")
	    ("t" "Todo")
	    ("tt" "Todo without time" entry (file+headline ,(concat org-directory "inbox.org") "Todo:")
	     "* TODO %?")
	    ("ts" "Todo with SCHEDULED" entry (file+headline ,(concat org-directory "inbox.org") "Todo:")
	     "* TODO %?\nSCHEDULED:%^t")
	    ("td" "Todo with DEADLINE" entry (file+headline ,(concat org-directory "inbox.org") "Todo:")
	     "* TODO %?\nDEADLINE:%^t"))
	  ;; org-refile-targets
	  ;; `((,(concat org-directory "note.org") :maxlevel . 2))
	  ;; `((,(concat org-directory "read.org") :maxlevel . 1)
	  ;; (,(concat org-directory "learn.org") :maxlevel . 1)
	  ;; (,(concat org-directory "emacs.org") :level . 1))
	  org-todo-keywords
	  '((sequence "TODO(t)" "CANCELED(c)" "|" "DONE(d)"))
	  org-todo-keyword-faces
	  '(("DAILY" . "green")
	    ("CANCELED" . "grey")))
    ;; set key
    (define-key global-map "\C-cc" 'org-capture)
    (define-key global-map "\M-q" 'org-agenda)
  #+END_SRC
* custom
  :PROPERTIES:
  :ID:       6B095511-4190-40D0-BE90-9539CE6BE0AA
  :END:
  #+BEGIN_SRC emacs-lisp
    (when (eq system-type 'gnu/linux)
      (custom-set-variables
       ;; custom-set-variables was added by Custom.
       ;; If you edit it by hand, you could mess it up, so be careful.
       ;; Your init file should contain only one such instance.
       ;; If there is more than one, they won't work right.
       '(package-selected-packages
	 '(ein flycheck py-autopep8 elpy diminish ace-window org-bullets restart-emacs all-the-icons pdf-tools projectile undo-tree yasnippet company counsel youdao-dictionary highlight-parentheses org-download neotree which-key magit exec-path-from-shell use-package))
       '(show-paren-mode t)
       '(tool-bar-mode nil))
      (custom-set-faces
       ;; custom-set-faces was added by Custom.
       ;; If you edit it by hand, you could mess it up, so be careful.
       ;; Your init file should contain only one such instance.
       ;; If there is more than one, they won't work right.
       '(default ((t (:family "Purisa" :foundry "PfEd" :slant normal :weight bold :height 120 :width normal))))
       '(aw-leading-char-face ((t (:inderit ace-jump-face-foreground :height 3.0))))))
  #+END_SRC
